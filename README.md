
<!-- README.md is generated from README.Rmd. Please edit that file -->

# DSMprey

<img src="man/figures/cvpia_logo.jpg" align="right" width="40%"/>

### Aggregated prey density across multiple watersheds

*This package is for sourcing prey density across multiple watersheds
and habitat types. Also included in this package are fish mass and and
fork length data as well as associated environmental (temperature and
dissolved oxygen) data. All data can be used in the CVPIA salmon life
cycle models.*

#### Installation

``` r
# install.packages("remotes")
remotes::install_github("CVPIA-OSC/DSMprey")
```

#### Usage

This package provides habitat related datasets to the
[`fallRunDSM,`](https://github.com/CVPIA-OSC/fallRunDSM)
[`springRunDSM,`](https://github.com/CVPIA-OSC/springRunDSM)
[`winterRunDSM,`](https://github.com/CVPIA-OSC/winterRunDSM) and
[`latefallRunDSM`](https://github.com/CVPIA-OSC/latefallRunDSM)
packages.

``` r
# datasets within the package
data(package = 'DSMprey')
```

#### About the Datasets

Datasets were aggregated from multiple authors and across many
watersheds. For each dataset, the habitat type was assigned. Specific
methods and supporting documents for data aggregation and decisions in
every watershed are provided on the reference tab.

##### Prey Density Datasets

-   `all_prey_density`

-   `monthly_prey_density`

##### Fish Datasets:

-   `all_fish_data`

-   `monthly_fish_data`

##### Environmental Datasets:

-   `all_enviro_data`

#### Joining Datasets

Datasets can be joined on `site`, see example below:

``` r
library(tidyverse)
#> ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.1 ──
#> ✔ ggplot2 3.3.5     ✔ purrr   0.3.4
#> ✔ tibble  3.1.6     ✔ dplyr   1.0.8
#> ✔ tidyr   1.2.0     ✔ stringr 1.4.0
#> ✔ readr   2.1.2     ✔ forcats 0.5.1
#> ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
#> ✖ dplyr::filter() masks stats::filter()
#> ✖ dplyr::lag()    masks stats::lag()
## All data: 
all_prey <- DSMprey::all_prey_density 
all_fish <- DSMprey::all_fish_data
all_enviro <- DSMprey::all_enviro_data 

# all prey density and fork length/mass data
all_prey_and_fish <- all_prey %>% left_join(all_fish) %>% glimpse()
#> Joining, by = c("site", "habitat_type", "date", "author", "watershed", "lat",
#> "lon")
#> Rows: 612,866
#> Columns: 18
#> $ site         <chr> "Butte Sink-BSA1", "Butte Sink-BSA1", "Butte Sink-BSA1", …
#> $ habitat_type <chr> "agricultural canal", "agricultural canal", "agricultural…
#> $ date         <dttm> 2021-02-15, 2021-02-15, 2021-02-08, 2021-02-22, 2021-02-…
#> $ species      <chr> "small cladocera", "copepoda", "small cladocera", "large …
#> $ prey_density <dbl> 3.751509373, 0.293736179, 4.866604482, 7.215024087, 0.117…
#> $ author       <chr> "Cordoleani", "Cordoleani", "Cordoleani", "Cordoleani", "…
#> $ watershed    <chr> "Butte Creek", "Butte Creek", "Butte Creek", "Butte Creek…
#> $ size_class   <chr> "meso", "meso", "meso", "meso", "meso", "meso", "meso", "…
#> $ gear_type    <chr> "net throw", "net throw", "net throw", "net throw", "net …
#> $ mesh_size    <dbl> 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 15…
#> $ lat          <dbl> 39.235, 39.235, 39.235, 39.235, 39.235, 39.235, 39.235, 3…
#> $ lon          <dbl> -121.947, -121.947, -121.947, -121.947, -121.947, -121.94…
#> $ life_stage   <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
#> $ Year         <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
#> $ Week         <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
#> $ fish_id      <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
#> $ mass         <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
#> $ fork_length  <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…

# join environmental data with prey density:
all_prey_and_enviro <- all_prey %>% left_join(all_enviro) %>% glimpse()
#> Joining, by = c("site", "habitat_type", "date", "author", "watershed")
#> Rows: 760,070
#> Columns: 18
#> $ site         <chr> "Butte Sink-BSA1", "Butte Sink-BSA1", "Butte Sink-BSA1", …
#> $ habitat_type <chr> "agricultural canal", "agricultural canal", "agricultural…
#> $ date         <dttm> 2021-02-15, 2021-02-15, 2021-02-15, 2021-02-15, 2021-02-…
#> $ species      <chr> "small cladocera", "small cladocera", "small cladocera", …
#> $ prey_density <dbl> 3.751509, 3.751509, 3.751509, 3.751509, 3.751509, 3.75150…
#> $ author       <chr> "Cordoleani", "Cordoleani", "Cordoleani", "Cordoleani", "…
#> $ watershed    <chr> "Butte Creek", "Butte Creek", "Butte Creek", "Butte Creek…
#> $ size_class   <chr> "meso", "meso", "meso", "meso", "meso", "meso", "meso", "…
#> $ gear_type    <chr> "net throw", "net throw", "net throw", "net throw", "net …
#> $ mesh_size    <dbl> 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 15…
#> $ lat          <dbl> 39.235, 39.235, 39.235, 39.235, 39.235, 39.235, 39.235, 3…
#> $ lon          <dbl> -121.947, -121.947, -121.947, -121.947, -121.947, -121.94…
#> $ life_stage   <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
#> $ Year         <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
#> $ Week         <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…
#> $ do_mg_l      <dbl> 8.04, 8.07, 8.00, 7.96, 8.08, 8.74, 8.91, 8.86, 8.83, 8.7…
#> $ temperature  <dbl> 10.32, 10.30, 10.26, 10.24, 10.28, 10.54, 11.10, 10.62, 1…
#> $ flow_cfs     <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…

## Monthly Data:
monthly_prey <- DSMprey::monthly_prey_density
monthly_fish <- DSMprey::monthly_fish_data

monthly_prey_and_fish <- monthly_prey %>% left_join(monthly_fish) %>% glimpse()
#> Joining, by = c("watershed", "habitat_type", "year", "month")
#> Rows: 928
#> Columns: 14
#> $ watershed           <chr> "Butte Creek", "Butte Creek", "Butte Creek", "Butt…
#> $ habitat_type        <chr> "agricultural canal", "agricultural canal", "agric…
#> $ year                <dbl> 2019, 2019, 2019, 2019, 2020, 2020, 2020, 2021, 20…
#> $ month               <dbl> 1, 2, 3, 4, 1, 2, 3, 1, 2, 3, 1, 2, 3, 4, 1, 2, 3,…
#> $ min_prey_density    <dbl> 0.0058946275, 0.0014147106, 0.0022104853, 0.005894…
#> $ max_prey_density    <dbl> 2.97089227, 1.15534699, 3.71361534, 2.48163819, 0.…
#> $ median_prey_density <dbl> 0.353677651, 0.033599377, 0.050929582, 0.040279955…
#> $ var_prey_density    <dbl> 4.564078e-01, 9.442357e-02, 9.118004e-01, 6.375711…
#> $ mass_min            <dbl> NA, NA, NA, NA, NA, 1.0500000, 1.0400000, NA, NA, …
#> $ fork_length_min     <dbl> NA, NA, NA, NA, NA, 56.78261, 56.78261, NA, NA, NA…
#> $ mass_max            <dbl> NA, NA, NA, NA, NA, 1.780000, 2.090000, NA, NA, NA…
#> $ fork_length_max     <dbl> NA, NA, NA, NA, NA, 56.78261, 56.78261, NA, NA, NA…
#> $ mass_median         <dbl> NA, NA, NA, NA, NA, 1.460000, 1.460000, NA, NA, NA…
#> $ fork_length_median  <dbl> NA, NA, NA, NA, NA, 56.78261, 56.78261, NA, NA, NA…
```

### Dependencies

The `DSMprey` package provides data for several other packages within
the [CVPIA Open Science Collaborative](https://github.com/CVPIA-OSC).
